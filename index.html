<!doctype html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>ã²ã‚ˆã“å½“ã¦ã‚²ãƒ¼ãƒ  ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --yellow-bg: #fff7d6;
      --yellow-main: #facc15;
      --yellow-deep: #f59e0b;
      --border-soft: #e5e7eb;
      --text-main: #111827;
      --text-sub: #6b7280;
      --danger: #ef4444;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      background: var(--yellow-bg);
      color: var(--text-main);
    }

    .app-root {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
    }

    .card {
      width: 100%;
      max-width: 420px;
      background: #fff;
      border-radius: 18px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.06);
      border: 1px solid #fef3c7;
      padding: 16px 16px 20px;
    }

    h1, h2 {
      margin: 0;
    }

    h1 {
      font-size: 20px;
      font-weight: 700;
      color: #92400e;
    }

    h2 {
      font-size: 18px;
      font-weight: 600;
      color: #92400e;
    }

    p {
      margin: 0;
    }

    .text-sub {
      font-size: 13px;
      color: var(--text-sub);
      line-height: 1.5;
    }

    .text-note {
      font-size: 11px;
      color: var(--text-sub);
      margin-top: 4px;
    }

    .text-center {
      text-align: center;
    }

    .mt-2 { margin-top: 8px; }
    .mt-3 { margin-top: 12px; }
    .mt-4 { margin-top: 16px; }
    .mt-6 { margin-top: 24px; }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      padding: 10px 14px;
      border-radius: 999px;
      border: none;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.15s ease, transform 0.05s ease, box-shadow 0.15s ease;
    }

    .btn-primary {
      background: var(--yellow-main);
      color: #78350f;
      box-shadow: 0 4px 12px rgba(250, 204, 21, 0.5);
    }

    .btn-primary:hover {
      background: #fde047;
      transform: translateY(-1px);
    }

    .btn-primary:active {
      transform: translateY(0);
      box-shadow: 0 2px 8px rgba(250, 204, 21, 0.4);
    }

    .btn-outline {
      background: #fff;
      color: var(--text-main);
      border: 1px solid var(--border-soft);
    }

    .btn-outline:hover {
      background: #f9fafb;
    }

    .btn-sm {
      padding: 7px 10px;
      font-size: 13px;
      font-weight: 500;
    }

    .btn[disabled] {
      opacity: 0.5;
      cursor: not-allowed;
      box-shadow: none;
      transform: none;
    }

    .chip {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 11px;
      background: #fef3c7;
      color: #92400e;
      border: 1px solid #fed7aa;
      margin-top: 4px;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 8px;
    }

    .chick-card {
      border-radius: 14px;
      background: #fff;
      border: 1px solid var(--border-soft);
      padding: 6px;
      display: flex;
      flex-direction: column;
      gap: 6px;
      cursor: pointer;
      transition: border 0.12s ease, box-shadow 0.12s ease, transform 0.05s ease;
    }

    .chick-card:hover {
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.06);
      transform: translateY(-1px);
    }

    .chick-card.selected {
      border: 2px solid var(--yellow-deep);
      box-shadow: 0 0 0 1px rgba(245, 158, 11, 0.2);
    }

    .chick-visual {
      width: 100%;
      padding-top: 100%;
      border-radius: 10px;
      background: #fef3c7;
      position: relative;
      overflow: hidden;
    }

    .chick-visual-inner {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 32px;
    }

    .chick-meta {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      font-size: 13px;
      font-weight: 600;
    }

    .gender-tag {
      font-size: 11px;
      color: var(--text-sub);
    }

    .section {
      margin-top: 12px;
    }

    .section-header {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      margin-bottom: 4px;
    }

    .counter-row {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      font-size: 13px;
      margin-bottom: 6px;
    }

    .progress-bar {
      width: 100%;
      height: 7px;
      border-radius: 999px;
      background: #e5e7eb;
      overflow: hidden;
    }

    .progress-value {
      height: 100%;
      border-radius: 999px;
      background: var(--yellow-main);
      width: 0%;
      transition: width 0.15s ease;
    }

    .text-danger {
      color: var(--danger);
      font-size: 11px;
      margin-top: 4px;
    }

    .result-visual {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      margin-top: 10px;
    }

    .result-title {
      font-size: 18px;
      font-weight: 700;
      color: #92400e;
    }

    .result-sub {
      font-size: 13px;
      color: var(--text-sub);
    }
  </style>
</head>
<body>
  <div class="app-root">
    <div class="card">
      <div id="view-start">
        <div class="text-center">
          <h1>ã²ã‚ˆã“å½“ã¦ã‚²ãƒ¼ãƒ </h1>
          <p class="text-sub mt-2">
            9åŒ¹ã®ã²ã‚ˆã“ã®ä¸­ã‹ã‚‰ã€<br />
            ç›¸æ‰‹ãŒã²ãã‹ã«é¸ã‚“ã 1åŒ¹ã‚’è³ªå•ã§å½“ã¦ã‚‹ã‚²ãƒ¼ãƒ ã€‚
          </p>
          <span class="chip mt-2">å¯¾é¢ã§éŠã¶å‰æã®ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—</span>
        </div>
        <button id="start-btn" class="btn btn-primary mt-4">
          ã‚²ãƒ¼ãƒ ã‚’ã¯ã˜ã‚ã‚‹
        </button>
        <p class="text-note mt-3">
          1. å›ç­”è€…ãŒã‚¹ãƒãƒ›ã‚’æŒã¡ã€ã²ã‚ˆã“ã‚’1åŒ¹ãˆã‚‰ã¶<br />
          2. ãã®ã‚ã¨è³ªå•è€…ã«ã‚¹ãƒãƒ›ã‚’æ¸¡ã™<br />
          3. è³ªå•è€…ã¯å£é ­ã§è³ªå•ã—ãªãŒã‚‰ã€ã©ã®ã²ã‚ˆã“ã‹å½“ã¦ã«ã„ã
        </p>
      </div>

      <div id="view-select" style="display:none;">
        <h2>å›ç­”è€…ã®ã²ã‚ˆã“ãˆã‚‰ã³</h2>
        <p class="text-sub mt-1">
          å›ç­”è€…ã ã‘ãŒç”»é¢ã‚’è¦‹ã¦ã€ã²ã‚ˆã“ã‚’1åŒ¹ã‚¿ãƒƒãƒ—ã—ã¦é¸ã¶ã€‚<br />
          é¸ã¹ãŸã‚‰ã€Œé¸ã‚“ã ï¼ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã€è³ªå•è€…ã«ã‚¹ãƒãƒ›ã‚’æ¸¡ã™ã€‚
        </p>
        <div id="select-grid" class="grid mt-3"></div>
        <button id="confirm-secret-btn" class="btn btn-primary mt-4" disabled>
          ã“ã®ã²ã‚ˆã“ã«æ±ºã‚ãŸï¼
        </button>
        <p class="text-note">
          â€» é¸ã‚“ã ã²ã‚ˆã“ã¯è³ªå•è€…ã«ã¯è¦‹ã›ãªã„ã§ãã ã•ã„ã€‚
        </p>
      </div>

      <div id="view-question" style="display:none;">
        <div class="section-header">
          <h2>è³ªå•ã‚¿ã‚¤ãƒ </h2>
          <span class="chip">è³ªå•ã¯å£é ­ã§</span>
        </div>
        <p class="text-sub mt-1">
          è³ªå•ã™ã‚‹ãŸã³ã«ã€Œè³ªå•ã—ãŸã®ã§ +1ã€ã‚’æŠ¼ã—ã¦ã€è³ªå•å›æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆã™ã‚‹ã€‚<br />
          ã€Œã‚‚ã†å½“ã¦ã«ã„ãã€ã‚’æŠ¼ã™ã¨ã€ã©ã®ã²ã‚ˆã“ã‹ã‚’é¸ã¶ç”»é¢ã«é€²ã‚€ã€‚
        </p>
        <div id="question-grid" class="grid mt-3"></div>
        <p class="text-note">
          â€» è³ªå•è€…ãƒ»å›ç­”è€…ã©ã¡ã‚‰ã‚‚ã€ã“ã®9åŒ¹ã‚’è¦‹ãªãŒã‚‰ã‚„ã‚Šã¨ã‚Šã™ã‚‹ã€‚
        </p>
        <div class="section mt-3">
          <div class="counter-row">
            <span>è³ªå•å›æ•°</span>
            <span><span id="question-count">0</span> / <span id="question-max">10</span></span>
          </div>
          <div class="progress-bar">
            <div id="question-progress" class="progress-value"></div>
          </div>
          <div id="question-warning" class="text-danger" style="display:none;">
            ã“ã‚Œä»¥ä¸Šã¯è³ªå•ã§ããªã„ã€‚ãã‚ãã‚ã€ã©ã®ã²ã‚ˆã“ã‹å½“ã¦ã«ã„ã“ã†ã€‚
          </div>
        </div>
        <div class="section mt-3">
          <button id="question-plus-btn" class="btn btn-primary">
            è³ªå•ã—ãŸã®ã§ +1
          </button>
          <button id="go-guess-btn" class="btn btn-outline mt-2">
            ã‚‚ã†å½“ã¦ã«ã„ã
          </button>
        </div>
      </div>

      <div id="view-guess" style="display:none;">
        <h2>ã©ã®ã²ã‚ˆã“ã ã£ãŸï¼Ÿ</h2>
        <p class="text-sub mt-1">
          å£é ­ã®ã‚„ã‚Šã¨ã‚Šã‚’æ€ã„å‡ºã—ã¦ã€ç›¸æ‰‹ãŒãˆã‚‰ã‚“ã ã¨æ€ã†ã²ã‚ˆã“ã‚’1åŒ¹ã‚¿ãƒƒãƒ—ã™ã‚‹ã€‚
        </p>
        <div id="guess-grid" class="grid mt-3"></div>
        <p class="text-note">
          ã‚¿ãƒƒãƒ—ã—ãŸã²ã‚ˆã“ãŒã€ã‚ãªãŸã®æœ€çµ‚å›ç­”ã«ãªã‚‹ã€‚
        </p>
      </div>

      <div id="view-result" style="display:none;">
        <div class="text-center">
          <div id="result-title" class="result-title">çµæœ</div>
          <div id="result-message" class="result-sub mt-1"></div>
        </div>
        <div class="result-visual">
          <div class="chick-visual" style="width:128px;">
            <div class="chick-visual-inner">
              <span id="result-emoji" style="font-size:34px;">ğŸ£</span>
            </div>
          </div>
          <div id="result-name" class="mt-1" style="font-size:14px;font-weight:600;"></div>
          <div id="result-gender" style="font-size:12px;color:var(--text-sub);"></div>
        </div>
        <p class="text-sub mt-3 text-center">
          è³ªå•å›æ•°: <span id="result-questions">0</span> å›
        </p>
        <div class="section mt-4">
          <button id="replay-btn" class="btn btn-primary">
            ã‚‚ã†ä¸€åº¦ã‚ãã¶
          </button>
          <button id="back-home-btn" class="btn btn-outline mt-2">
            ãƒ›ãƒ¼ãƒ ã«ã‚‚ã©ã‚‹
          </button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // --- åå‰ãƒ»æ€§åˆ¥ãƒ»ã²ã‚ˆã“ç”»åƒãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ ---------------------------

    const NAMES_CUTE = [
  "ãã„ã‚", "ã¡ã‚…ã‚“", "ã´ã‚ˆã¾ã‚‹", "ãŸã¾ã”", "ã“ã‚€ã", "ã¾ã‚", "ã¿ã‚‹ã", "ã·ã‚Šã‚“", "ã¡ã£ã´", "ã»ã£ãº",
  "ã´ã£ã´", "ãŸã¾", "ã¡ãƒ¼ãš", "ã‚ãŸ", "ã“ã¤ã¶", "ãƒ—ãƒªãƒ³", "ã´ãƒ¼ã™", "ãŠã‚‚ã¡", "ããªã“", "ãŠã¯ã",
  "ãƒã‚¿ãƒ¼", "ã ã‚“ã”", "ãƒ“ã‚¹ã‚³", "ã¿ãŸã‚‰ã—", "ã†ã©ã‚“", "ãƒ©ãƒ¼ãƒ¡ãƒ³", "ã‚«ãƒ¬ãƒ¼"
];
    const NAMES_TOUGH = [
  "å¤ªè”µ", "å‰›å¿—", "ç„äººï¼ˆãã‚ã†ã¨ï¼‰", "æ­¦è”µ", "éš¼äºº", "å¤§æ²³", "æ˜‡é¾", "å‰£ï¼ˆã¤ã‚‹ãï¼‰", "é‰„å¹³", "çƒˆç«",
  "è¿…ï¼ˆã˜ã‚“ï¼‰", "é›·ï¼ˆã„ã‹ãšã¡ï¼‰", "éš¼ï¼ˆã¯ã‚„ã¶ã•ï¼‰", "å¤§ç‰™ï¼ˆãŸã„ãŒï¼‰", "é­ï¼ˆã‹ã„ï¼‰", "ä¸€å¾¹", "ç‰™ï¼ˆãã°ï¼‰",
  "å·Œï¼ˆã„ã‚ãŠï¼‰", "é™£ï¼ˆã˜ã‚“ï¼‰", "å‰›", "ç‹ç‰™ï¼ˆãŠã†ãŒï¼‰", "ç«œé¦¬", "è±ª", "æ–¬ï¼ˆã–ã‚“ï¼‰", "è™é‰„", "åå…µè¡›", "å¡Šï¼ˆã‹ã„ï¼‰"
];
    const NAMES_AMERICAN = [
  "ãƒãƒ£ãƒ¼ãƒªãƒ¼", "ãƒ‡ã‚¤ã‚¸ãƒ¼", "ãƒãƒƒã‚¯ã‚¹", "ãƒ¬ã‚ªãƒ³", "ã‚¨ãƒªã‚ªãƒƒãƒˆ", "ãƒ´ã‚£ãƒ³ã‚»ãƒ³ãƒˆ", "ãƒ­ãƒ¼ã‚¬ãƒ³", "ã‚¸ã‚§ã‚¤ã‚¯",
  "ãƒãƒªã‚½ãƒ³", "ã‚¹ã‚«ãƒ¼ãƒ¬ãƒƒãƒˆ", "ãƒ‰ã‚¯ã‚¿ãƒ¼", "ãƒ¢ãƒ¼ã‚¬ãƒ³", "ã‚¯ãƒªã‚¹", "ãƒãƒ‡ã‚£ã‚½ãƒ³", "ã‚ªãƒ¼ã‚¦ã‚§ãƒ³",
  "ã‚·ãƒ‰ãƒ‹ãƒ¼", "ã‚´ãƒƒã‚µãƒ ", "ãƒ€ã‚°ãƒ©ã‚¹"
];

    const NAMES_OJISAN = [
  "ã²ã‚ã—", "ã¾ã•ãŠ", "ãˆã„ã˜", "ã‘ã‚“ã„ã¡", "ãŸã‘ã—", "ã—ã’ãŠ", "ã‚ˆã—ãŠ", "ãŸã‹ã—", "ã‚ããŠ", "ã‹ãšãŠ",
  "ã¨ã—ã‚†ã", "ã¤ã‚ˆã—", "ã¨ã—ãŠ", "ã¿ã®ã‚‹", "ã•ã¨ã—", "ã•ã ãŠ", "ã²ã§ã‹ãš", "ã®ã‚ŠãŠ", "ã¾ã•ã—", "ã‘ã‚“ã˜",
  "ãŸã¤ãŠ", "ãã‚ˆã—", "ã‚ˆã—ã‚ã", "ãˆã„ã•ã"
];

const ALL_NAMES = [...NAMES_CUTE, ...NAMES_TOUGH, ...NAMES_AMERICAN, ...NAMES_OJISAN];
    const MAX_QUESTIONS = 10;

    // ã²ã‚ˆã“ç”»åƒ URL ãƒªã‚¹ãƒˆ
    const IMAGE_URLS = [
      "https://thumbs.dreamstime.com/b/petit-poussin-mignon-dehors-59498627.jpg",
      "https://img.lovepik.com/photo/60162/4812.jpg_wh860.jpg",
      "https://img.lovepik.com/photo/60181/3115.jpg_wh860.jpg",
      "https://i.pinimg.com/474x/f5/11/b4/f511b40b1466a4f7ef540a78ed7a238e.jpg",
      "https://www.publicdomainpictures.net/pictures/160000/nahled/mignon-poussin-jaune.jpg",
      "https://www.google.com/url?sa=i&url=https%3A%2F%2Fwww.tradexgroups.com%2Findex.phppshopdetail%2F159014442&psig=AOvVaw21u6mLBCstWXA9GZHdq5JW&ust=1763538414657000&source=images&cd=vfe&opi=89978449&ved=0CBUQjRxqFwoTCNC64dma-5ADFQAAAAAdAAAAABBY",
      "https://www.google.com/url?sa=i&url=http%3A%2F%2Fblog.livedoor.jp%2Fpikchu123%2Farchives%2F1079691913.html&psig=AOvVaw21u6mLBCstWXA9GZHdq5JW&ust=1763538414657000&source=images&cd=vfe&opi=89978449&ved=0CBUQjRxqFwoTCNC64dma-5ADFQAAAAAdAAAAABBi",
      "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR2toZz9gZ_Ini3LkQOaKDR7z1eSsfL6033Qg&s",
      "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT5M-K-sQjMBNTk_hrVtEMNzWQpJrndKLTl1g&s",
      "https://cdn.qleanmarket.amanaimages.com/uploads/items/032/033/34/preview/FYI03203334.jpg",
      "https://www.photolibrary.jp/mhd2/img498/450-2016110515152173081.jpg",
      "https://www.nitori-net.jp/ecstatic/image/product/7980723/798072301.jpg?ts=20240208101825572&imwidth=500&imdensity=1",
      "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS4LXoT6HdzcHUxFMbRivxRSGeort69zkLcbw&s",
      "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQbO4PYDYcgsCdPIdujX7UDnpIhcbFIiKVwVg&s",
      "https://baseec-img-mng.akamaized.net/images/item/origin/818272a029b9dd2e628135e5933e8ea7.jpg?imformat=generic",
      "https://stat.ameba.jp/user_images/20190425/23/goma-tuki/2e/e2/j/o0640048014397713972.jpg",
      "https://png.pngtree.com/png-clipart/20240520/original/pngtree-cute-fluffy-little-chick-hatches-from-a-huge-egg-png-image_15140470.png",
      "https://p.potaufeu.asahi.com/e110-p/picture/26989847/0a464ee4c83747cb8ea8f0b705520b7b_640px.jpg",
      "https://prcdn.freetls.fastly.net/release_image/18131/5353/18131-5353-b07b6895b724d10059c6d74e3d304bbf-1000x1000.jpg?format=jpeg&auto=webp&fit=bounds&width=2400&height=1260",
      "https://img.freepik.com/premium-photo/cute-chick-wooden-surface-closeup-baby-animal_495423-64753.jpg",
      "https://media.istockphoto.com/id/1153077069/ja/%E3%82%B9%E3%83%88%E3%83%83%E3%82%AF%E3%83%95%E3%82%A9%E3%83%88/%E3%81%B2%E3%82%88%E3%81%93%E8%8B%A5%E3%81%84%E8%B5%A4%E3%81%A1%E3%82%83%E3%82%93%E3%81%AF%E5%AE%B6%E7%A6%BD%E8%BE%B2%E5%A0%B4%E3%81%A7%E5%BD%BC%E3%82%92%E6%8E%A2%E3%81%97%E3%81%A6%E3%81%84%E3%81%BE%E3%81%99%E8%B5%A4%E3%81%A1%E3%82%83%E3%82%93%E3%81%B2%E3%82%88%E3%81%93%E3%81%8B%E3%82%8F%E3%81%84%E3%81%84%E7%84%A1%E9%82%AA%E6%B0%97%E3%82%B3%E3%83%B3%E3%82%BB%E3%83%97%E3%83%88.jpg?s=1024x1024&w=is&k=20&c=MrfMoCgNnznRXKIxDPohUh7J44ha_kpQ4A1qvqwjKWk=",
      "https://previews.123rf.com/images/takadahiroto/takadahiroto1611/takadahiroto161100007/66968771-cute-baby-chick.jpg",
      "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRstQorrj2RXLH4yzg8EOhfN-2VW5XxFjPlHwCJo7bKIVGMh6FwpWqo4QGb4F1uhIqn9Ys&usqp=CAU",
      "https://www.publicdomainpictures.net/pictures/100000/nahled/cute-baby-chick.jpg",
      "https://d2o4rrq92x9csx.cloudfront.net/articles/Gazo_2507-4-123.webp",
      "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTxtnBI3L3etsu-BX6N3-XZY9-DKLaEQyayBvgLahcnEAdAnHUVNZ0eTlkaqwxdfcpZPgs&usqp=CAU",
      "https://eternalcollegest.com/wp-content/uploads/2020/04/hiyoko-3-43.jpg",
      "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRHisx-HsnwL5_3EeVflgiIi3PewZmBIAxhtA&s"
    ];

    // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ç”¨ã®ã²ã‚ˆã“ç”»åƒãƒ—ãƒ¼ãƒ«ï¼ˆç”Ÿæˆæ™‚ã«ã‚»ãƒƒãƒˆï¼‰
    let fallbackImagePool = [];

    /** @returns {"male"|"female"} */
    function randomGender() {
      return Math.random() < 0.5 ? "male" : "female";
    }

    function randomItem(arr) {
      return arr[Math.floor(Math.random() * arr.length)];
    }

    // åå‰ãƒ»ç”»åƒã‚’ã€Œé‡è¤‡ãªã—ã€ã§9ä½“åˆ†å‰²ã‚Šå½“ã¦ã‚‹
    function generateChicks(count = 9) {
      const maxCount = Math.min(count, ALL_NAMES.length, IMAGE_URLS.length);

      const namesPool = [...ALL_NAMES];
      const imagesPool = [...IMAGE_URLS];

      namesPool.sort(() => Math.random() - 0.5);
      imagesPool.sort(() => Math.random() - 0.5);

      const result = [];
      const now = Date.now();

      // ã²ã‚ˆã“æœ¬ä½“ã«ä½¿ã†ç”»åƒï¼ˆé‡è¤‡ãªã—ï¼‰
      const usedImages = imagesPool.slice(0, maxCount);
      // å£Šã‚ŒãŸã¨ãã«å·®ã—è¾¼ã‚€å€™è£œï¼ˆã¾ã ä½¿ã£ã¦ã„ãªã„ç”»åƒï¼‰
      fallbackImagePool = imagesPool.slice(maxCount);

      for (let i = 0; i < maxCount; i += 1) {
        const name = namesPool[i];
        const imageUrl = usedImages[i];

        result.push({
          id: "chick-" + i + "-" + now + "-" + Math.random().toString(16).slice(2),
          name,
          gender: randomGender(),
          imageUrl
        });
      }

      return result;
    }

    // --- çŠ¶æ…‹ ------------------------------------------------------

    let chicks = [];
    let secretChickId = null; // å›ç­”è€…ãŒé¸ã‚“ã ã²ã‚ˆã“
    let guessChickId = null;  // è³ªå•è€…ã®æœ€çµ‚å›ç­”
    let questionCount = 0;

    // --- DOM ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ ----------------------------------------

    const viewStart    = document.getElementById("view-start");
    const viewSelect   = document.getElementById("view-select");
    const viewQuestion = document.getElementById("view-question");
    const viewGuess    = document.getElementById("view-guess");
    const viewResult   = document.getElementById("view-result");

    const startBtn           = document.getElementById("start-btn");
    const selectGrid         = document.getElementById("select-grid");
    const confirmSecretBtn   = document.getElementById("confirm-secret-btn");
    const questionCountEl    = document.getElementById("question-count");
    const questionMaxEl      = document.getElementById("question-max");
    const questionProgressEl = document.getElementById("question-progress");
    const questionWarningEl  = document.getElementById("question-warning");
    const questionGrid       = document.getElementById("question-grid");
    const questionPlusBtn    = document.getElementById("question-plus-btn");
    const goGuessBtn         = document.getElementById("go-guess-btn");
    const guessGrid          = document.getElementById("guess-grid");

    const resultTitleEl     = document.getElementById("result-title");
    const resultMessageEl   = document.getElementById("result-message");
    const resultEmojiEl     = document.getElementById("result-emoji");
    const resultNameEl      = document.getElementById("result-name");
    const resultGenderEl    = document.getElementById("result-gender");
    const resultQuestionsEl = document.getElementById("result-questions");
    const replayBtn         = document.getElementById("replay-btn");
    const backHomeBtn       = document.getElementById("back-home-btn");

    // --- ç”»é¢åˆ‡ã‚Šæ›¿ãˆ ----------------------------------------------

    function showView(name) {
      viewStart.style.display    = name === "start"    ? "" : "none";
      viewSelect.style.display   = name === "select"   ? "" : "none";
      viewQuestion.style.display = name === "question" ? "" : "none";
      viewGuess.style.display    = name === "guess"    ? "" : "none";
      viewResult.style.display   = name === "result"   ? "" : "none";
    }

    // --- UI ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° -------------------------------------------

    function createChickImageElement(chick) {
      const img = document.createElement("img");
      img.src = chick.imageUrl;
      img.alt = chick.name;
      img.style.width = "100%";
      img.style.height = "100%";
      img.style.objectFit = "cover";
      img.loading = "lazy";

      // å£Šã‚ŒãŸç”»åƒã¯ã€ã¾ã ä½¿ã£ã¦ã„ãªã„ç”»åƒã®ä¸­ã‹ã‚‰å·®ã—æ›¿ãˆ
      img.onerror = () => {
        img.onerror = null;
        if (fallbackImagePool && fallbackImagePool.length > 0) {
          img.src = fallbackImagePool.shift();
        } else {
          // ã™ã¹ã¦ä½¿ã„åˆ‡ã£ã¦ã„ãŸå ´åˆã¯ã€æœ€å¾Œã®æ‰‹æ®µã¨ã—ã¦æœ€åˆã®ç”»åƒã‚’å†åˆ©ç”¨
          img.src = IMAGE_URLS[0];
        }
      };

      return img;
    }

    function renderSelectGrid() {
      selectGrid.innerHTML = "";
      chicks.forEach(chick => {
        const card = document.createElement("div");
        card.className = "chick-card";
        card.dataset.id = chick.id;
        if (chick.id === secretChickId) {
          card.classList.add("selected");
        }

        const visual = document.createElement("div");
        visual.className = "chick-visual";
        const inner = document.createElement("div");
        inner.className = "chick-visual-inner";

        inner.appendChild(createChickImageElement(chick));
        visual.appendChild(inner);

        const meta = document.createElement("div");
        meta.className = "chick-meta";
        const nameSpan = document.createElement("span");
        nameSpan.textContent = chick.name;
        const genderSpan = document.createElement("span");
        genderSpan.className = "gender-tag";
        genderSpan.textContent = chick.gender === "male" ? "â™‚" : "â™€";

        meta.appendChild(nameSpan);
        meta.appendChild(genderSpan);

        card.appendChild(visual);
        card.appendChild(meta);

        card.addEventListener("click", () => {
          secretChickId = chick.id;
          renderSelectGrid();
          confirmSecretBtn.disabled = false;
        });

        selectGrid.appendChild(card);
      });
    }

    function renderGuessGrid() {
      guessGrid.innerHTML = "";
      chicks.forEach(chick => {
        const card = document.createElement("div");
        card.className = "chick-card";
        card.dataset.id = chick.id;

        const visual = document.createElement("div");
        visual.className = "chick-visual";
        const inner = document.createElement("div");
        inner.className = "chick-visual-inner";

        inner.appendChild(createChickImageElement(chick));
        visual.appendChild(inner);

        const meta = document.createElement("div");
        meta.className = "chick-meta";
        const nameSpan = document.createElement("span");
        nameSpan.textContent = chick.name;
        const genderSpan = document.createElement("span");
        genderSpan.className = "gender-tag";
        genderSpan.textContent = chick.gender === "male" ? "â™‚" : "â™€";

        meta.appendChild(nameSpan);
        meta.appendChild(genderSpan);

        card.appendChild(visual);
        card.appendChild(meta);

        card.addEventListener("click", () => {
          guessChickId = chick.id;
          showResult();
        });

        guessGrid.appendChild(card);
      });
    }

    // è³ªå•ã‚¿ã‚¤ãƒ ç”¨ï¼š9åŒ¹ã‚’ä¸€è¦§ã§è¡¨ç¤ºï¼ˆé¸æŠæ“ä½œãªã—ï¼‰
    function renderQuestionGrid() {
      if (!questionGrid) return;
      questionGrid.innerHTML = "";
      chicks.forEach(chick => {
        const card = document.createElement("div");
        card.className = "chick-card";
        card.dataset.id = chick.id;

        const visual = document.createElement("div");
        visual.className = "chick-visual";
        const inner = document.createElement("div");
        inner.className = "chick-visual-inner";

        inner.appendChild(createChickImageElement(chick));
        visual.appendChild(inner);

        const meta = document.createElement("div");
        meta.className = "chick-meta";
        const nameSpan = document.createElement("span");
        nameSpan.textContent = chick.name;
        const genderSpan = document.createElement("span");
        genderSpan.className = "gender-tag";
        genderSpan.textContent = chick.gender === "male" ? "â™‚" : "â™€";

        meta.appendChild(nameSpan);
        meta.appendChild(genderSpan);

        card.appendChild(visual);
        card.appendChild(meta);

        questionGrid.appendChild(card);
      });
    }

    function renderQuestionStatus() {
      questionCountEl.textContent = String(questionCount);
      questionMaxEl.textContent = String(MAX_QUESTIONS);
      const ratio = Math.min(1, questionCount / MAX_QUESTIONS);
      questionProgressEl.style.width = (ratio * 100) + "%";

      if (questionCount >= MAX_QUESTIONS) {
        questionWarningEl.style.display = "";
        questionPlusBtn.disabled = true;
      } else {
        questionWarningEl.style.display = "none";
        questionPlusBtn.disabled = false;
      }
    }

    function showResult() {
      if (!secretChickId || !guessChickId) return;

      const secret = chicks.find(c => c.id === secretChickId);
      const isCorrect = secretChickId === guessChickId;

      if (!secret) return;

      resultTitleEl.textContent = isCorrect ? "æ­£è§£ï¼" : "æ®‹å¿µâ€¦ ã¯ãšã‚Œ";
      resultEmojiEl.textContent = isCorrect ? "ğŸ‰" : "ğŸ˜¢";
      resultMessageEl.textContent = isCorrect
        ? "è¦‹äº‹ã«å½“ã¦ã‚‹ã“ã¨ãŒã§ããŸã€‚"
        : "ä»Šå›ã¯å¤–ã‚Œã¦ã—ã¾ã£ãŸã€‚æ¬¡ã¯å½“ã¦ã‚ˆã†ã€‚";

      resultNameEl.textContent = secret.name;
      resultGenderEl.textContent = "æ€§åˆ¥: " + (secret.gender === "male" ? "â™‚" : "â™€");
      resultQuestionsEl.textContent = String(questionCount);

      showView("result");
    }

    // --- ã‚¤ãƒ™ãƒ³ãƒˆè¨­å®š ----------------------------------------------

    startBtn.addEventListener("click", () => {
      chicks = generateChicks(9);
      secretChickId = null;
      guessChickId = null;
      questionCount = 0;
      confirmSecretBtn.disabled = true;
      renderSelectGrid();
      showView("select");
    });

    confirmSecretBtn.addEventListener("click", () => {
      if (!secretChickId) return;
      questionCount = 0;
      renderQuestionStatus();
      renderQuestionGrid();
      showView("question");
    });

    questionPlusBtn.addEventListener("click", () => {
      if (questionCount >= MAX_QUESTIONS) return;
      questionCount += 1;
      renderQuestionStatus();
    });

    goGuessBtn.addEventListener("click", () => {
      renderGuessGrid();
      showView("guess");
    });

    replayBtn.addEventListener("click", () => {
      chicks = generateChicks(9);
      secretChickId = null;
      guessChickId = null;
      questionCount = 0;
      confirmSecretBtn.disabled = true;
      renderSelectGrid();
      showView("select");
    });

    backHomeBtn.addEventListener("click", () => {
      showView("start");
    });

    // åˆæœŸè¡¨ç¤º
    showView("start");
  </script>
</body>
</html>
